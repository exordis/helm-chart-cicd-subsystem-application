
## Definition

``` yaml
configMaps:
  config1:
    # defaults to application namespace based on convention
    namespace: "my-namespace"
    # defaults to empty dict
    labels: 
      extra-label: "label value"
    # defaults to empty dict
    annotations: 
      extra-annotation: "annotation value"
    data:
      value1: "test"
      value2: "123"
  config2:
    containers:
      - applicationContainer
    data:
      value: "test"
```

`namespace`

:   secret namespace

    **default:** subsystem namespace generated by convention

`labels`

:   list of labels to add to secret in addition to [common labels](../common metadata.md)

    **default:** empty dict

`annotations`

:   list of annotations to add to secret in addition to [common annotations](../common metadata.md)

    **default:** empty dict

`containers`

:   list of container ids to add `configMapRef` for the configMap. If  `containers` is not provided, `secretRef` would be added to all containers in configMap namespace

    **default:** nil (add `configMapRef` to all containers)

`stringData`

:   `data` to be added to configmap manifest

    **default:** empty dict


## Validations

- ConfigMap `id` is unique. `envs` id is reserved for [envs config map](../values.md#envs-config-map)
- Each item in `containers` references `applicationContainer` or existing `id` in `init-container` or `sidecars`
- Each item in `containers` belongs to the same some-namespace as the secret

## Overrides

`name`

:   `name` is generated from id by [convention](../naming conventions.md)

## Manifest Generation 

- `configMapRef` is added to containers  with ids listed in `configmap.containers` (all if this field is not set)
- annotation with checksum of configmap is added to workloads manifests if at least one container of has `configMapRef` added
- configmap manifest is generated:

    ``` yaml
    ---
    apiVersion: v1
    kind: ConfigMap
    metadata:
      name: some-subsystem-some-application-some-instance-config1
      namespace: my-namespace
      labels:
          app.kubernetes.io/component: some-subsystem-some-application
          app.kubernetes.io/instance: some-instance
          app.kubernetes.io/managed-by: helm
          app.kubernetes.io/name: some-subsystem-some-application
          app.kubernetes.io/part-of: some-subsystem
          app.kubernetes.io/version: 1.0.0
          exordis/application: some-subsystem-some-application
          exordis/application-instance: some-instance
          exordis/application-type: service
          exordis/environment: test
          exordis/product: Some Product
          exordis/subsystem: some-subsystem
          extra-label: label value
          helm.sh/chart: cicd-subsystem-application-0.1.0
      annotations:
          extra-annotation: annotation value
    data:
      value1: test
      value2: "123"
    ---
    apiVersion: v1
    kind: ConfigMap
    metadata:
      name: some-subsystem-some-application-some-instance-config2
      namespace: some-subsystem-test
      labels:
          app.kubernetes.io/component: some-subsystem-some-application
          app.kubernetes.io/instance: some-instance
          app.kubernetes.io/managed-by: helm
          app.kubernetes.io/name: some-subsystem-some-application
          app.kubernetes.io/part-of: some-subsystem
          app.kubernetes.io/version: 1.0.0
          exordis/application: some-subsystem-some-application
          exordis/application-instance: some-instance
          exordis/application-type: service
          exordis/environment: test
          exordis/product: Some Product
          exordis/subsystem: some-subsystem
          helm.sh/chart: cicd-subsystem-application-0.1.0
      annotations:
        {}
    data:
      value: test
    ```


